!function(){"use strict";angular.module("jbl",["ui.router","ui.bootstrap","ui.select"])}(),function(){"use strict";function e(){function e(){}var t={restrict:"E",templateUrl:"app/components/navbar/navbar.html",controller:e,controllerAs:"vm",bindToController:!0};return t}angular.module("jbl").directive("navbar",e)}(),function(){"use strict";function e(e,t,a,n){var l=this;l.collapsed=!1,l.showGraph=!1,l.selected={courses:null,topics:null,chapters:null,assessments:null},l.by={step1:null,step2:null,step3:null},l.courses=[],l.topics=[],l.chapters=[],l.assessments=[],l.toArray=function(e){return Object.keys(e).map(function(t){return e[t]})},l.openAdv=function(){return null===l.selected.courses?void alert("Select some courses"):void(l.collapsed=!l.collapsed)},l.getCourses=function(){var e=angular.copy(n.BASE_PARAMS);angular.extend(e,n.PARAMS.COURSES),a({url:n.BASE_URI,method:"GET",cache:!0,params:e,paramSerializer:"$httpParamSerializerJQLike"}).then(function(e){l.courses=l.toArray(angular.fromJson(e.data))},function(){t.debug("Request Failed")})},l.getActivities=function(){var e=angular.copy(n.BASE_PARAMS);angular.extend(e,n.PARAMS.ACTIVITY),a({url:n.BASE_URI,method:"GET",cache:!0,params:e,paramSerializer:"$httpParamSerializerJQLike"}).then(function(e){l.engagements=l.toArray(angular.fromJson(e.data))},function(){t.debug("Request Failed")})},l.getChapters=function(){l.selected.chapters=null,l.selected.topics=null,l.selected.assessments=null;var e=angular.copy(n.BASE_PARAMS);angular.extend(e,n.PARAMS.CHAPTERS),a({url:n.BASE_URI,method:"GET",cache:!0,params:e,paramSerializer:"$httpParamSerializerJQLike"}).then(function(e){l.chapters=l.toArray(angular.fromJson(e.data))},function(){t.debug("Request Failed")})},l.getTopics=function(){l.selected.chapters=null,l.selected.topics=null,l.selected.assessments=null;var e=angular.copy(n.BASE_PARAMS);angular.extend(e,n.PARAMS.TOPICS),e.courseVal=function(){var e=[];return angular.forEach(l.selected.courses,function(t){e.push(t.id)}),"["+e.join(",")+"]"}(),a({url:n.BASE_URI,method:"GET",cache:!0,params:e}).then(function(e){l.topics=l.toArray(angular.fromJson(e.data))},function(){t.debug("Request Failed")})},l.getAssesments=function(){var e=angular.copy(n.BASE_PARAMS);if(e=angular.extend(e,n.PARAMS.ASSETS),null!==l.selected.courses){var s=[];angular.forEach(l.selected.courses,function(e){s.push(e.id)}),e.courseVal="["+s.join(",")+"]"}if(null!==l.selected.topics){var i=[];angular.forEach(l.selected.topics,function(e){i.push(e.id)}),e.sectionVal="["+i.join(",")+"]"}null!==l.by.step1&&(e.gradelabel=l.by.step1,e.gradeVal=l.by.step1),a({url:n.BASE_URI,method:"GET",cache:!0,params:e}).then(function(e){l.assessments=l.toArray(angular.fromJson(e.data))},function(){t.debug("Request Failed")})},l.showReport=function(){var e=angular.copy(n.BASE_PARAMS);if(e=angular.extend(e,n.PARAMS.REPORT),null===l.by.step1)return void alert("Complete Step 1 by selecting either by grade or by engagement");if(e.gradelabel=l.by.step1,e.gradeVal=l.by.step1,null===l.by.step2)return void alert("Complete Step 2 by selecting either chapters or topics");if(e.sectiontype=l.by.step2,l.engagements.length>0&&"engagement"===l.by.step1){var s=[];if(angular.forEach(l.engagements,function(e){e.selected===!0&&s.push(e.name)}),s.length<=0)return void alert("Select atleast an activity type in step 1");e.activitylable=s.join(",")}if(null===l.selected.courses)return alert("Select atleast one course."),void(l.collapsed=!1);var i=[];if(angular.forEach(l.selected.courses,function(e){i.push(e.id)}),e.courseVal="["+i.join(",")+"]",null!==l.selected.topics){var c=[];angular.forEach(l.selected.topics,function(e){c.push(e.id)}),e.sectionVal="["+c.join(",")+"]"}else if(null!==l.selected.chapters){var r=[];angular.forEach(l.selected.topics,function(e){r.push(e.id)}),e.sectionVal="["+r.join(",")+"]"}a({url:n.BASE_URI,method:"GET",cache:!0,params:e}).then(function(e){var t=angular.fromJson(e.data);return t.total>0?(l.createGraph(l.toArray(t.data)),void(l.collapsed=!1)):void alert("No Records found")},function(){t.debug("Request Failed")})},l.createGraph=function(t){var a={x:["x"]},n={};angular.forEach(t,function(e,t){a.x.push(e.studentName),"engagement"===l.by.step1?angular.forEach(e.grade,function(e){angular.isUndefined(a[e.quizType])&&(a[e.quizType]=[],n[e.quizType]=!0),angular.isUndefined(a[e.quizType][t+1])?a[e.quizType][t]=parseInt(e.timespend):a[e.quizType][t]=parseInt(a[e.quizType][t])+parseInt(e.timespend)}):"grade"===l.by.step1&&angular.forEach(e.grade,function(e){angular.isUndefined(a[e.quizType])&&(a[e.quizType]=[e.quizType],n[e.quizType]=!0),angular.isUndefined(a[e.quizType][t+1])?a[e.quizType][t+1]=parseInt(e.grade):a[e.quizType][t+1]=parseInt(a[e.quizType][t+1])+parseInt(e.grade)})}),e(function(){l.showGraph=!0,l.graphReport=c3.generate({bindto:"#jbl-graph-report",data:{x:"x",columns:l.toArray(a),type:"bar",labels:!0,colors:{pattern:["#7babc0","#d71920","#5c284b","#004b91"]},group:Object.keys(n)},size:{height:600},legend:{position:"inset"},axis:{rotated:!0,x:{type:"category",label:{text:"Student Name",position:"outer-top"}},y:{label:{text:"grade"===l.by.step1?"Grade":"Time Spent",position:"inner-bottom"}}},bar:{width:{ratio:.5}},grid:{y:{show:!0}}}),e(function(){l.graphReport.flush()},10)},0)},l.getCourses(),l.getActivities()}angular.module("jbl").controller("MainController",e),e.$inject=["$timeout","$log","$http","JBL_CONSTANTS"]}(),function(){"use strict";function e(e){e.debug("runBlock end")}angular.module("jbl").run(e),e.$inject=["$log"]}(),function(){"use strict";function e(e,t){e.state("home",{url:"/",templateUrl:"app/main/main.html",controller:"MainController",controllerAs:"main"}),t.otherwise("/")}angular.module("jbl").config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";angular.module("jbl").constant("JBL_CONSTANTS",{BASE_URI:"http://bparlapalliascend.dev.jbldev.com:8027/local/graph/customrest.php",BASE_PARAMS:{wsfunction:"graph",wstoken:"86c1a6de874cfb200b78dba83dbdc491",moodlewsrestformat:"json"},PARAMS:{COURSES:{type:"courselist"},CHAPTERS:{type:"chapterlist"},TOPICS:{type:"topiclist",courseVal:null},ACTIVITY:{type:"activity"},ASSETS:{type:"assetlist",courseVal:null,sectionlabel:"",sectionVal:null,gradelabel:"",gradeVal:""},REPORT:{type:"report1",courseVal:null,gradelabel:"",gradeVal:"",sectionlabel:"",sectionVal:null,sectiontype:"",assetlabel:"",assetVal:null,activitylable:"",studentlabel:""}}})}(),function(){"use strict";function e(e){e.debugEnabled(!0)}angular.module("jbl").config(e),e.$inject=["$logProvider"]}(),angular.module("jbl").run(["$templateCache",function(e){e.put("app/main/main.html",'<div class="row-fluid"><div class="navbar navbar-static-top navbar-inverse filter-bar"><div class="container-fluid"><div class="row-fluid"><div class="col-md-3"><h1>Analytics</h1></div><div class="col-md-7 course-select"><ui-select multiple="" theme="bootstrap" data-ng-model="main.selected.courses"><ui-select-match placeholder="Select Courses ...">{{$item.name}}</ui-select-match><ui-select-choices repeat="course in main.courses | filter:$select.search">{{course.name}}</ui-select-choices></ui-select></div><div class="col-md-2"><div class="btn-group"><button data-ng-click="main.openAdv()" class="btn btn-warning btn-lg">Advanced <span class="caret"></span></button></div></div><div class="col-md-12 panel panel-default adv-filter hidden" data-ng-class="main.collapsed ? \'visible\': \'hidden\'" data-ng-hide="!main.collapsed"><div class="panel-body"><div class="col-md-3"><div class="btn-group-vertical btn-block"><label class="btn btn-default" data-ng-model="main.by.step1" btn-radio="\'grade\'">By Grade</label> <label class="btn btn-default" data-ng-model="main.by.step1" btn-radio="\'engagement\'">By Engagement</label></div><div class="btn-group-vertical engagement-container hidden" data-ng-show="main.by.step1 == \'engagement\'" data-ng-class="main.by.step1 == \'engagement\' ? \'visible\' : \'hidden\'"><h5 class="text-primary">Activity List</h5><label class="btn btn-primary" btn-checkbox="" data-ng-model="type.selected" data-ng-repeat="type in main.engagements">{{type.name}}</label></div></div><div class="col-md-3"><div class="btn-group-vertical btn-block"><label class="btn btn-default" data-ng-click="main.getChapters()" data-ng-model="main.by.step2" btn-radio="\'chapter\'">By Chapter</label> <label class="btn btn-default" data-ng-click="main.getTopics()" data-ng-model="main.by.step2" btn-radio="\'topic\'">By Topic</label></div><ui-select multiple="" theme="bootstrap" data-ng-model="main.selected.chapters" data-ng-show="main.by.step2 == \'chapter\'"><ui-select-match placeholder="Select Chapter ...">{{$item.name}}</ui-select-match><ui-select-choices repeat="chapter in main.chapters | filter:$select.search">{{chapter.name}}</ui-select-choices></ui-select><ui-select multiple="" theme="bootstrap" data-ng-model="main.selected.topics" data-ng-show="main.by.step2 == \'topic\'"><ui-select-match placeholder="Select Topic ...">{{$item.name}}</ui-select-match><ui-select-choices repeat="topic in main.topics | filter:$select.search">{{topic.name}}</ui-select-choices></ui-select></div><div class="col-md-3"><div class="btn-group-vertical btn-block"><label class="btn btn-default" data-ng-click="main.getAssesments()" data-ng-disabled="main.by.step2 !=\'topic\'" data-ng-model="main.by.step3" btn-radio="\'assessment\'">By Assessment</label></div><ui-select multiple="" theme="bootstrap" data-ng-model="main.selected.assessments" data-ng-show="main.by.step3 == \'assessment\'"><ui-select-match placeholder="Select Assessment ...">{{$item.name}}</ui-select-match><ui-select-choices repeat="assessment in main.assessments | filter:$select.search">{{assessment.name}}</ui-select-choices></ui-select></div><div class="col-md-3"><div class="btn-group-vertical btn-block"><label class="btn btn-default" data-ng-model="main.by.step4" btn-radio="\'top\'">Top 33%</label> <label class="btn btn-default" data-ng-model="main.by.step4" btn-radio="\'middle\'">Middle Select %</label> <label class="btn btn-default" data-ng-model="main.by.step4" btn-radio="\'bottom\'">Bottom Select %</label> <label class="btn btn-default" data-ng-model="main.by.step4" btn-radio="\'all\'">All</label></div><button type="button" data-ng-click="main.showReport()" class="show-report btn btn-success btn-block">Show Report</button></div></div></div></div></div></div><div class="col-md-10 col-md-offset-1 graph-wrapper" data-ng-show="main.showGraph"><legend>Report</legend><div id="jbl-graph-report" class="chart"></div></div></div>'),e.put("app/components/navbar/navbar.html",'<nav class="navbar navbar-static-top navbar-default jbl-navbar"><div class="container-fluid"><div class="navbar-header"><a class="navbar-brand" href=""><img src="assets/images/logo.png" class="header-image" alt="" "jbl="" reports"=""></a></div></div></nav>')}]);
//# sourceMappingURL=../maps/scripts/app-b07a83360e.js.map
